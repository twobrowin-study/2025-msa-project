# OTUS | Микросервисная архитектура | 2025

Автор: Дубровин Е.Н.

Содержит в себе ответы по ДЗ для курса "Микросервисная архитектура" до тех пор, пока это имеет смысл вести в одном репозитории

## ДЗ 2 | Приложение в docker-образ и запушить его на Dockerhub

**Цель:** В этом ДЗ вы сможете обернуть приложение в docker-образ и запушить его на Dockerhub.

**Вариант 1 (С КОДОМ)**

Шаг 1. Создать минимальный сервис, который

```
    отвечает на порту 8000
    имеет http-метод:
        GET /health/
        RESPONSE: {"status": "OK"}
```

Шаг 2. Cобрать локально образ приложения в докер контейнер под архитектуру AMD64.

Запушить образ в dockerhub

### Локальный запуск проекта

Проект находится в директории `demoapp`

```bash
cd demoapp

go run src/main.go
```

### Сборка и пуш контейнера

```bash
docker build demoapp --push -t twobrowin/2025-msa-project:demoapp-hw2-0.1
```

## ДЗ 3 | Основы работы с Kubernetes

**Цель:** В этом ДЗ вы научитесь создавать минимальный сервис.

**Вариант 1 (С КОДОМ)**

Написать манифесты для деплоя в k8s для этого сервиса.


Манифесты должны описывать сущности: Deployment, Service, Ingress.

В Deployment могут быть указаны Liveness, Readiness пробы.

Количество реплик должно быть не меньше 2. Image контейнера должен быть указан с Dockerhub.


Хост в ингрессе должен быть arch.homework. В итоге после применения манифестов GET запрос на http://arch.homework/health должен отдавать {“status”: “OK”}.


*Задание со звездой:*

В Ingress-е должно быть правило, которое форвардит все запросы с /otusapp/{student name}/* на сервис с rewrite-ом пути. Где {student name} - это имя студента.

Например: curl arch.homework/otusapp/aeugene/health -> рерайт пути на arch.homework/health

### Развёртывание сервиса в k8s

```bash
kubectl apply -f k8s-manifests
```